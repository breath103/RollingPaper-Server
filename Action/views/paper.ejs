<%
	function toDegree(radian){	
		return radian / (Math.PI * 2 ) * 360;
	}
	var originalScreenSize = 400;
%>
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script src="http://ricostacruz.com/jquery.transit/jquery.transit.min.js"></script>
<script> 
	var rollingpaper = <%-JSON.stringify(paper)%>
	
	$(document).ready(function(){
		onBodyResize();
		$(".sound_content").click(function(){
			var audio = $( $(this).find("audio")[0] );
			console.log(audio);
			audio[0].play();
		});
	});
	function onBodyResize(){
		$(".retain_size_ratio_base_height").each(function(i,e){
			var $e = $(e);
			var size_ratio = Number($(this).attr("size_ratio"));
			var width = $(this).height() / size_ratio;
			$(this).width(width);
			var pos_ratio = Number($(this).attr("position_ratio"));
			var left = $(this).position().top / pos_ratio;
			$(this).css("left",left);
		});
	}
</script>
<title>Rolling Paper</title>
<style type="text/css">
html,body {
	padding: 0px;
	border: 0px;
	margin: 0px;
	overflow: hidden;
	width:100%;
	height:100%;
}

.image_content{
	border-radius:10px 10px 10px 10px;
}
.image_content img{
	border-radius:30px 30px 30px 30px;
//	box-shadow: 10px 10px 10px gray;
}

a:link {
	color: #9a9e72;
	text-decoration: none;
} /* unvisited link */
a:visited {
	color: #9a9e72;
} /* visited link */
a:hover {
	color: #BDB76B;
} /* mouse over link */
a:active {
	color: #0f4e3a;
} /* selected link */
.Container {
	position: static;
	width: 1600px;
	height: 770px;
	width:100%;
	height:100%;
}

.Left {
	float: left;
	position: relative;
	width: 13%;
	height: 100%;
	background-color: #0f4e3a;
	box-shadow: 0 0 29px 8px #888888;
	left: 0px;
	right: 0px;
	z-index: 1;
}

.Logo {
	width: 80%;
	height: 17%;
	background-image: url("images/Rolling_Paper_Logo.png");
	background-size: 80% 80%;
	background-repeat: no-repeat;
	background-position: center;
}

.Logo_Name {
	width: 90%;
	height: 3%;
	background-color: #0f4e3a;
	color: #ccbb86;
	text-align: center;
	text-shadow: 1px 1px 1px #888888;
}

.Logo_down_shadow {
	width: 73%;
	height: 3%;
	border: 1px solid #a6a577;
	border-bottom-style: none;
	border-left-style: none;
	border-right-style: none;
	background-image: url("images/web_shadow.png");
	background-size: 100% 100%;
}

.From_down_shadow {
	position: absolute;
	width: 73%;
	height: 3%;
	top: 83%;
	left: 0px;
	border: 1px solid #a6a577;
	border-bottom-style: none;
	border-left-style: none;
	border-right-style: none;
	background-image: url("images/web_shadow.png");
	background-size: 100% 100%;
	-webkit-transform: rotate(180deg);
}

.Place_To {
	width: 85%;
	height: 3%;
	background-color: #0f4e3a;
	color: #ccbb86;
	font-size: 100%;
}

.Place_Holder {
	width: 73%;
	height: 19%;
	background-color: #0c3b2d;
	border: #f64e02 dashed 2px;
	border-radius: 4px;
	color: #ccbb86;
	font-size: 150%;
	font-weight: bold;
	color: #ccbb86;
	background: -webkit-gradient(radial, 50% 50%, 0, 50% 1%, 150, from(#0a402f),
		to(#0c3b2c) );
	text-align: center;
}

.Place_Mark {
	position: absolute;
	width: 66%;
	height: 2%;
	background-image: url("images/web_apostrophe.png");
	background-size: 100% 100%;
	top: 44%;
	left: 17%;
}

.Place_Participate_Text {
	position: absolute;
	width: 50%;
	height: 12%;
	top: 46%;
	left: 25%;
	color: #ccbb86;
	text-align: center;
	font-weight: bold;
}

.Place_From {
	width: 85%;
	height: 3%;
	background-color: #0f4e3a;
	color: #ccbb86;
	font-size: 100%;
}

.Participate {
	width: 72%;
	height: 27%;
	background-color: #0f4e3a;
	color: #9a9e72;
	overflow: scroll;
	overflow-x: hidden;
}

.Participate_List {
	width: 100%;
	height: 20%;
}

.Part_Image {
	float: left;
	width: 26%;
	height: 100%;
	background-color: #1a533e;
}

.Part_Name {
	float: right;
	width: 70%;
	height: 0%;
	background-color: #0f4e3a;
	line-height: 40px;
}

::-webkit-scrollbar {
	width: 8px;
	height: 8px;
}

::-webkit-scrollbar-button {
	display: none;
}

::-webkit-scrollbar-track {
	background: #1a533e;
}

::-webkit-scrollbar-thumb {
	width: 8px;
	height: 8px;
	background: #738762;
}

.Right {
	float: right;
	width: 87%;
	height: 100%;
	display: inline;
	overflow: scroll;
	overflow-y: hidden;
}

.Right_Center {
	float: right;
	width: 100%;
	height: 100%;
	background-image: url("images/web_paper.png");
	position: relative;
}

.Place_Holder2 {
	width: 100%;
	height: 90%;
}

.Date {
	width: 13%;
	height: 10%;
	background-color: #ccbb86;
	float: right;
	line-height: 200%;
	font-weight: bold;
	box-shadow: 3px 1px 7px #888888;
}

.Place_Date {
	width: 5%;
	height: 10%;
	float: right;
}

.Mo_Left {
	float: left;
	width: 5%;
	height: 100%;
}
.Place_Holder2{
	width:90%;
}

.Mo_Right {
	float: right;
	width: 5%;
	height: 100%;
}
</style>
<script type="text/javascript">
	function play() {

		alert("a");

	}
</script>
</head>
<body onresize="onBodyResize();">
	<div class="Container" style="margin: auto;">
		<div class="Left">
			<div class="Logo" style="margin: 15% auto auto 8%;"></div>
			<!-- 로고 이미지란  -->
			<div class="Logo_Name" style="margin: auto auto auto 5%;">Rolling
				Paper</div>
			<!-- 로고이름란 -->
			<div class="Logo_down_shadow" style="margin: 10% auto auto 15%;"></div>
			<!-- logo : 로고 선(border)과 그림자효과 (gradient) -->
			<div class="From_down_shadow" style="margin: 9% auto auto 15%"></div>
			<!-- from : 로고 선(border)과 그림자효과 (gradient) -->
			<div class="Place_To" style="margin: 24% auto auto 12%;">
				<font face=arial>&nbsp;To. </font> 
					<a href="https://www.facebook.com/<%-paper.receiver_fb_id%>" target=_blank><font face=arial><%-paper.receiver_name%></font></a>
			</div>
			<!-- To. 받는사람이름 -->
			<div class="Place_Holder" style="margin: 5% auto 20% 13%;">
			</div>
			<!-- 받는 Title -->
			<div class="Place_Mark"></div>
			<!-- 큰따옴표 -->
			<div class="Place_Participate_Text"><%-paper.title%></div>
			<!-- 메세지 title적는 란 -->
			<div class="Place_From" style="margin: -5% auto 1% 12%;">
				<font face=arial>&nbsp;From.</font>
			</div>
			<!-- From. 보낸사람이름 -->
			<div class="Participate" style="margin: 3% auto 20% 16%;">
				<% paper.participants.forEach(function printBr(e, i, array) { %>
				<div class="Participate_List"
					style="margin: auto auto 4% auto;">
					<div class="Part_Image"
						style="margin: auto auto auto auto;">
						<a href="https://www.facebook.com/<%-e.facebook_id%>"
							target=_blank><img alt="name1"
							src="<%-e.picture%>"
							width=100% height=100%></a>
					</div>
					<div class="Part_Name"
						style="margin: auto auto auto auto;">
						<a href="https://www.facebook.com/<%-e.facebook_id%>"
							target=_blank><%-e.name%></a>
					</div>
				</div>
				<!-- Participate List -->
				<%});%>
			</div>
			<!-- 보내는 사람들 명단 -->
		</div>
		<!-- 왼쪽칸 -->
		<div class="Right">

			<div class="Right_Center">
				
				<div class="Mo_Left" style="display:inline-block"></div>
				<!-- 왼쪽 마우스 오버 -->
				
				<div class="Place_Holder2" style="position:relative;float:left;display:inline-block">
					<%if(paper.image){
					paper.image.forEach(function(e,i) {
					var heightratio = e.height / originalScreenSize;
					var y_ratio = e.y / originalScreenSize;
					var size_ratio = e.height/e.width;
					var position_ratio = e.y/e.x; //우선 오리지널 화면 사이즈에 대한 컨텐츠의 높이 비를 계산한다
					%>
					<div class ="image_content retain_size_ratio_base_height" 
						position_ratio = "<%-position_ratio%>"
						size_ratio ="<%-size_ratio%>"
						style ="width:<%-e.width%>px;height:<%-heightratio*100%>%;position:absolute;left:<%-e.x%>px;top:<%-y_ratio*100%>%;-webkit-transform:rotate(<%-toDegree(e.rotation)%>deg);">
						<img style="width:100%;height:100%;" src="<%-e.image.replace('localhost',server_ip)%>"/>
					</div>
					<%});
				}%>
				<%if(paper.sound){
					paper.sound.forEach(function(e,i) {
					e.height = 50;
					e.width  = 50;
					e.rotation = 0;
					var heightratio = e.height / originalScreenSize;
					var y_ratio = e.y / originalScreenSize;
					var size_ratio = e.height/e.width;
					var position_ratio = e.y/e.x; //우선 오리지널 화면 사이즈에 대한 컨텐츠의 높이 비를 계산한다
					%>
					<div class ="sound_content retain_size_ratio_base_height" 
						position_ratio = "<%-position_ratio%>"
						size_ratio ="<%-size_ratio%>"
						style ="width:<%-e.width%>px;height:<%-heightratio*100%>%;position:absolute;left:<%-e.x%>px;top:<%-y_ratio*100%>%;-webkit-transform:rotate(<%-toDegree(e.rotation)%>deg);">
						<img style="width:100%;height:100%;" src="images/speaker2.png"/>
						<audio controls="controls" style="display:none">
							<source src="<%-e.sound.replace('localhost',server_ip)%>" type="audio/wav">
							Your browser does not support the audio element.
						</audio>
					</div>
					<%});
				}%>
				
				</div>
				<div class="Mo_Right" style="display:inline-block"></div>
				<!-- 오른쪽 마우스 오버 -->
				<!-- center칸 맞추기 보조 -->
				<div class="Place_Date"></div>
				<!-- 날짜칸 칸 보조 -->
				<div class="Date">
					<font color=#728560>&nbsp;<%-paper.created_time%></font>
				</div>
				<!-- 날짜 -->
			</div>
			<!-- 오른쪽 가운데 칸 -->
		</div>
		<!-- 오른쪽 메인 칸 -->
	</div>
	<!-- 전체 container칸 -->

</body>
</html>